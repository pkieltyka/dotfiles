{ pkgs, lib, ...}:
with lib;

let machine = import ~/.dotfiles/machine.nix;

in

{
  enable = true;
  hooks.postswitch = {
    "set wallpaper" = "${pkgs.i3}/bin/i3-msg reload";
    #"restart compton" = "killall compton"; 
  };

  profiles = mkMerge [

    # laptop
    (mkIf (machine == "laptop") {
      "mobile" = {
        fingerprint.eDP-1 = "00ffffffffffff0006af362000000000001b0104a51f117802fbd5a65334b6250e505400000001010101010101010101010101010101e65f00a0a0a040503020350035ae100000180000000f0000000000000000000000000020000000fe0041554f0a202020202020202020000000fe004231343051414e30322e30200a00d2";
        config.eDP-1 = {
          enable = true;
          primary = true;
          mode = "2560x1440";
          position = "0x0";
          rate = "60.01";
        };
      };
      "home-4k" = {
        fingerprint = {
          eDP-1 = "00ffffffffffff0006af362000000000001b0104a51f117802fbd5a65334b6250e505400000001010101010101010101010101010101e65f00a0a0a040503020350035ae100000180000000f0000000000000000000000000020000000fe0041554f0a202020202020202020000000fe004231343051414e30322e30200a00d2";
          DP-1 = "00ffffffffffff001e6d095b7c020400031c0104b53c22789e3035a7554ea3260f50542108007140818081c0a9c0d1c08100010101014dd000a0f0703e803020650c58542100001a286800a0f0703e800890650c58542100001a000000fd00383d1e8738000a202020202020000000fc004c4720556c7472612048440a20011a0203117144900403012309070783010000023a801871382d40582c450058542100001e565e00a0a0a029503020350058542100001a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c8";
        };
        config = {
          DP-1 = {
            enable = true;
            primary = true;
            mode = "3840x2160";
            position = "0x0";
            rate = "60.00";
          };
          eDP-1 = {
            enable = true;
            mode = "2560x1440";
            position = "0x2160";
            rate = "60.01";
          };
        };
      };
      "work-4k" = {
        fingerprint = {
          eDP-1 = "00ffffffffffff0006af362000000000001b0104a51f117802fbd5a65334b6250e505400000001010101010101010101010101010101e65f00a0a0a040503020350035ae100000180000000f0000000000000000000000000020000000fe0041554f0a202020202020202020000000fe004231343051414e30322e30200a00d2";
          DP-1 = "00ffffffffffff001e6d095bd8c40700071c0104b53c22789e3035a7554ea3260f50542108007140818081c0a9c0d1c08100010101014dd000a0f0703e803020650c58542100001a286800a0f0703e800890650c58542100001a000000fd00383d1e8738000a202020202020000000fc004c4720556c7472612048440a2001f50203117144900403012309070783010000023a801871382d40582c450058542100001e565e00a0a0a029503020350058542100001a0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000c8";
        };
        config = {
          DP-1 = {
            enable = true;
            primary = true;
            mode = "3840x2160";
            position = "0x0";
            rate = "60.00";
          };
          eDP-1 = {
            enable = true;
            mode = "2560x1440";
            position = "0x2160";
            rate = "60.01";
          };
        };
      };
    })

    # desktop
    (mkIf (machine == "desktop") {
      "home-4k" = {
        fingerprint.HDMI-1 = "00ffffffffffff001e6d085b7c020400031c0103803c2278ea3035a7554ea3260f50542108007140818081c0a9c0d1c081000101010108e80030f2705a80b0588a0058542100001e04740030f2705a80b0588a0058542100001a000000fd00383d1e873c000a202020202020000000fc004c4720556c7472612048440a20018c020330714d902220050403020161605d5e5f230907076d030c002000b83c20006001020367d85dc401788003e30f0003023a801871382d40582c450058542100001a565e00a0a0a029503020350058542100001a000000000000000000000000000000000000000000000000000000000000000000000000000000000000009d";
        config.HDMI-1 = {
          enable = true;
          primary = true;
          mode = "3840x2160";
          position = "0x0";
          rate = "60.00";
        };
      };
    })

  ];

}
